---
title: |
  [Ecrire son code dans un environnement de programmation lettr√©e]{.title}
subtitle: |
   [<img src="img/logo_notebook_orange.png" width="60%"/>]{.subtitle} 
author:
  - name: Hugues Pecout 
    affiliations:
      - name: UMR G√©ographie-Cit√©s - CNRS
footer: Semaine Data SHS -D√©cembre 2022 - Universit√© Paris-Cit√©
format:
  revealjs:
    incremental: true
    theme: [black, styles.scss]
    highlight-style: zenburn
    css: style.css
    logo: img/logo_hp.png
editor: visual
controls: true
progress: true
touch: true
chalkboard: 
  theme: chalkboard
slide-number: true
engine: knitr
filters:
  - markdown-examples.lua
---

## [Bonjour √† tout¬∑te¬∑s]{.smaller}

::: bigspace
Ing√©nieur d'√©tudes CNRS en sciences de l'information g√©ographique dans le domaine de la g√©ographie quantitative (UMR G√©ographie-Cit√©s).
:::

::: moy1
Depuis 2016 :
:::

::: {#list .nonincremental style="font-size:25px;line-height:25px;"}
-   √âvite l'utilisation de logiciels clic-bouton (QGIS, EXCEL, Philcarto...)
-   [**Analyse de donn√©es r√©alis√©e exclusivement avec le langage R**]{.orange}
-   Cr√©ation quasi hebdomadaire de script R.
-   Gain de productivit√© et de polyvalence important, mais...\
:::

::: moy1
**‚Üí Implique de [nouvelles m√©thodes de travail]{.orange} :**
:::

::: {.nonincremental style="font-size:25px;line-height:25px;"}
-   **Comment rendre mon travail intelligible pour mes coll√®gues (et pour moi) ?**
-   **Comment mettre √† disposition du code ?**
-   **Comment archiver et assurer une certaine reproductibilit√© de mes scripts ?**
:::

#  {data-background="img/Literate_Programming_book_cover.jpg" data-background-size="25%"}

## [Literate programming]{.smaller}

::: big
La [**programmation lettr√©e**]{.orange} est une approche de la programmation qui se veut diff√©rente du paradigme de programmation structur√©e.
:::

::: {style="font-size:20px;margin-top:30px;margin-bottom:30px;"}
> ¬´ *Nous devons changer notre attitude traditionnelle envers la construction des programmes : au lieu de consid√©rer que notre t√¢che principale est de dire √† un ordinateur ce qu'il doit faire, appliquons-nous plut√¥t √† expliquer √† des √™tres humains ce que nous voulons que l'ordinateur fasse.* (...)
>
> *Celui qui pratique la programmation lettr√©e peut √™tre vu comme un essayiste, qui s'attache principalement √† exposer son sujet dans un style visant √† l'excellence. Tel un auteur, il choisit, avec soin, le dictionnaire √† la main, les noms de ses variables et en explique la signification pour chacune d'elles. Il cherche donc √† obtenir un programme compr√©hensible parce que ses concepts sont pr√©sent√©s dans le meilleur ordre possible. Pour cela, il utilise un m√©lange de m√©thodes formelles et informelles qui se compl√®tent.* ¬ª
>
> **D. Knuth**, [¬´ Literate Programming ¬ª, The Computer Journal, British Computer Society, vol. 27, no 2,‚Äé 1984, p. 97--111](https://academic.oup.com/comjnl/article/27/2/97/343244?login=true)
:::

::: big
Le paradigme de la programmation lettr√©e, [pens√© et mis en oeuvre par **Donald Knuth** (1977-78)]{.orange}, s'√©loigne dans son √©criture de l'ordonnancement impos√© par l'ordinateur, et √† la place [**autorise les d√©veloppeurs √† utiliser un ordre impos√© par la logique et le fil de leur pens√©e**.]{.orange}
:::

------------------------------------------------------------------------

::: columns
::: {.column width="50%" style="font-size:30px;text-align:center;"}
[Quelques lignes de code...]{.orange}

```{r}
#| eval: TRUE
#| include: TRUE
#| echo : TRUE
#| fig-height: 7
#| code-line-numbers: FALSE


library(ggplot2)
ggplot(data = iris, 
       aes(x = cut(Sepal.Length, breaks = c(min(Sepal.Length), 5, 6, 7, max(Sepal.Length)), 
                   include.lowest = TRUE, labels = c("Bas","Bas+","Haut","Haut+")))) +
  geom_bar() + xlab("") + ylab("") + ggtitle("R√©partition par classe") +
  theme(plot.title = element_text(size=27), axis.text=element_text(size=19))



```
:::

::: {.column width="50%" style="font-size:30px;text-align:center;"}
[...En programmation lettr√©e]{.orange}

```{r}
#| eval: FALSE
#| include: TRUE
#| echo : TRUE
#| code-line-numbers: FALSE

#-----------------------------------------------------------------
#            Repr√©sentation graphique 
#         de la r√©partition d'individus
#          discr√©tis√© en quatre classes 
#
#                  H. Pecout
#               5 d√©cembre 2022
#-----------------------------------------------------------------

## Discr√©tisation la variable Sepal.Length (donn√©es iris)

# Statistiques sur la s√©rie statistique 'Sepal.Length'
summary(iris$Sepal.Length)

# Histogramme de la distribution
hist(iris$Sepal.Length)

# Choix des bornes de classes (amplitude √©gale)
bornes_des_classes <- c(min(iris$Sepal.Length), 5, 6, 7, 
                        max(iris$Sepal.Length))

# Choix des noms de classes
nom_des_classes <- c("Tr√©s petites","petites","grandes","Tr√®s grandes")

# Discr√©tisation de la variable 'Sepal.length'
iris$classe  <- cut(iris$Sepal.Length,
                    breaks = bornes_des_classes,
                    labels = nom_des_classes,
                    include.lowest = TRUE)

#---------------------------------------------------------------------

## Repr√©sentation des la distribution selon la discr√©tisation

# Biblioth√®que pour la repr√©sentation graphique
library(ggplot2)

# Repr√©sentation graphique de la distribution
ggplot(data = iris, aes(x = classe)) +  # Choix des donn√©es et de la variable √† repr√©senter
  geom_bar() +  # Choix du type de repr√©sentation
  xlab("") +    # Suppression du nom de l'axe x
  ylab("") +    # Suppression du nom de l'axe y
  ggtitle("R√©partition par classe") +  # Titre du graphique
  theme(plot.title = element_text(size=27),  # Taille de la police titre 
        axis.text=element_text(size=19))     # Taille des labels d'axe


```
:::
:::

## [Quel outil pour la PL ?]{.smaller}

::: moy
Il est possible de faire de la programmation lettr√©e dans n'importe quel type de document... Ce paradigme n'est pas li√© √† format ou √† un outil. Mais il en existe tout de m√™me un parfait pour mettre en oeuvre ce concept.
:::

::: columns
::: {.column width="30%"}
![](img/logo_gt_notebook_orange.png){width="79%"}
:::

::: {.column width="70%"}
::: big
**Le notebook permet de combiner du langage naturel et du langage de programmation**, et d'interpr√©ter les deux :

::: nonincremental
-   Mise en forme du texte\
-   Ex√©cution et/ou affichage du code\

\

::: bigbis
**Les notebooks et la programmation lettr√©e ont √©merg√©s √† la m√™me p√©riode, celle de l'√©mergence du concept de recherche reproductible...**
:::
:::
:::
:::
:::

## [üíª 70's show]{.smaller}

::: columns
::: {.column width="40%"}
::: bigorange
**Les premiers notebooks**
:::

::: {.nonincremental style="font-size:25px;line-height:25px;margin-top:20px;"}
-   1970 : Scratchpad (Axiom)
-   1987 : MathCad
-   1988 : Mathematica
-   1989 : Maple
-   2011 : IPython
:::

![](img/Wolfram-Language-on-early-Mac.png){width="80%"}
:::

::: {.column width="60%"}
::: bigorange
**√âmergence de la recherche reproductible**
:::

::: small
[**Jon Claerbout**](https://en.wikipedia.org/wiki/Jon_Claerbout) est l'un des premiers chercheur a exprimer le fait que **les m√©thodes de calcul menacent la reproductibilit√© de la recherche** si l'on ne donne pas un acc√®s libre aux donn√©es et aux logiciels qui sous-tendent.

En 1976, il publie un ouvrage r√©f√©rence en traitement de signal :\
¬´ ***Fundamentals of Geophysical Data Processing*** ¬ª

Cette 1√®re version - non-reproductible - sera le d√©but d'un long travail de recherche sur la reproductibilit√©... Via des notebooks !
:::

\

::: bigorange
**√âmergence du Literate Programming**
:::

::: moy
Le concept de **programmation lettr√©e** est pens√© et con√ßu par **Donald Knuth** (1977-78). Le notebook se pr√©sente comme un outil id√©al pour mettre en ≈ìuvre ce paradigme.
:::
:::
:::

#  {data-background="img/logo_notebook_orange.png" data-background-size="45%"}

## [D√©finition]{.smaller}

::: big
**Interface de programmation qui permet de combiner des sections en langage naturel et des sections en langage informatique.**
:::

::: bigrey2
De nombreuses d√©nominations existent :
:::

::: {.nonincremental style="color:grey;font-size:22px;text-align:center;"}
-   *Article ex√©cutable*
-   *Document computationnel*
-   *Document √©lectronique interactif*
-   *Cahiers de programmation*
-   *Cahier √©lectronique d'analyse*
-   *Calepin √©lectronique*
-   *Carnet de code*
-   *Manifeste algorithmique*
-   **Notebook !**
-   *...*
:::

## [Un outils... des pratiques !]{.smaller}

::: div0
![](img/notebook_1.png){width="100%"}
:::

::: bigrey
La mise en forme du texte se fait √† l'aide d'un langage de balisage (Markdown, html...)
:::

## [Anatomie d'un notebook]{.smaller}

::: bigspacecenter
Un simple fichier texte (.rmd, .qmd, .ipynb...)
:::

![](img/notebook_2.png){width="100%"}

<!-- ## Notebook sans code ? -->

<!-- <img src="img/notebook_3.png" style="margin-top:120px;" width="1000"/> -->

<!-- ## Stylo d'Human-Num -->

<!-- <p class="smallpcenter" style="margin-top:40px;"> -->

<!-- D√©velopp√© par le [CRC-EN](https://ecrituresnumeriques.ca/fr/) avec le support [√ârudit](https://www.erudit.org/fr/) et de la [TGIR Huma-Num](https://www.huma-num.fr/) -->

<!-- </p> -->

<!-- <img src="img/stylo.png" style="margin-top:5px;" width="550"/> -->

<!-- <p class="smallpcenter" style="margin-top:30px;"> -->

<!-- Sinon, il existe beaucoup d'√©diteurs libres ([CodiMD](https://hackmd.io/MVFMDJaVTkKM-s4IUz_q7A?both)...) -->

<!-- </p> -->

##  {.scrollable}

::: columns
::: {.column width="95%"}
``` {.markdown .eval}
\

### Le Markdown

Markdown est un **langage de balisage l√©ger** cr√©√© en 2004 par 
[John Gruber](https://fr.wikipedia.org/wiki/John_Gruber), 
avec l'aide d'[Aaron Swartz](https://fr.wikipedia.org/wiki/Aaron_Swartz), 
dans le but d'offrir une **syntaxe facile √† lire et √† √©crire**. 

![](https://upload.wikimedia.org/wikipedia/commons/6/64/John_Gruber%2C_2009_%28cropped%29.jpg)
**John Gruber, 2004 : **

> ¬´ *Un document balis√© par Markdown peut √™tre lu en l'√©tat sans donner 
l‚Äôimpression d'avoir √©t√© balis√© ou format√© par des instructions particuli√®res.* ¬ª

Un document balis√© par Markdown peut √™tre converti en :   

>- HTML  
>- PDF  
>- plein d'autres formats[^1]   

[^1]: Un markdown peut √©galement √™tre converti en format word, LaTeX, ePub, odt...

\

#### Ins√©rer du code ?

~~~R
library(ggplot2)
ggplot(data = iris, 
       aes(x = cut(Sepal.Length, breaks = c(min(Sepal.Length), 5, 6, 7, max(Sepal.Length)), 
                   include.lowest = TRUE, labels = c("Bas","Bas+","Haut","Haut+")))) +
  geom_bar() + 
  xlab("") + 
  ylab("") + 
  ggtitle("R√©partition par classe") +
  theme(plot.title = element_text(size=27), axis.text=element_text(size=19))
~~~
```
:::

::: {.column width="5%" style="font-size:30px;text-align:center;"}
:::
:::

## [Les notebooks en SHS]{.smaller}

::: center
![](img/nouveau_notebook.png){width="80%"}
:::

## [2022, l'ann√©e <img src="img/quarto.png" width="230" style="margin-top:0px;margin-bottom:-10px;"/>]{.smaller}

::: center
![](img/quarto2.png){width="90%"}
:::

<!-- ::: moycenter -->
<!-- [**Quarto**](https://quarto.org/) permet l'utilisation de **R**, **Python**, **Julia**, **Javascript** (**OJS**)... -->
<!-- ::: -->

## [Nombreux usages & formats]{.smaller}

::: right3
[Equivalent LaTeX + [**interactivit√©**]{.orange} :]{.txt2}

::: {.nonincremental style="font-size:60%;margin-top:0px;"}
-   TOC, bibliographie, note de bas de page...
-   Feuille de style CSS
-   Et bien plus... voir [Quarto](https://quarto.org/)
:::

\ 

[Un [**format de publication**]{.orange}<br> scientifique l√©gitime !]{.txt2}

::: {.nonincremental style="font-size:60%;margin-top:0px;"}
-   [Rzine](rzine.fr), pour la pratique de R en SHS

-   [Computo](https://computo.sfds.asso.fr/) de la SFdS

-   [Programming Historian](https://programminghistorian.org)
:::
:::

::: left3
[Nombreux templates,<br>[**multiples usages**]{.orange} :]{.txt2}

::: {.nonincremental style="font-size:60%;margin-top:0px;"}
-   [*Article*]{style="color:grey;"}

-   [*Manuel*]{style="color:grey;"}

-   [*Rapports*]{style="color:grey;"}

-   [*Livre*]{style="color:grey;"}

-   [*Tutoriel*]{style="color:grey;"}

-   [*Cours - Exercice*]{style="color:grey;"}

-   [*Blog - Site web*]{style="color:grey;"}

-   [*curriculum vitae*]{style="color:grey;"}

-   [*Diaporama*]{style="color:grey;"}

-   [*...*]{style="color:grey;"}
:::
:::

# [Programmation lettr√©e, notebook et [reproductibilit√©]{.orange}]{.txt2}

## [Programmation lettr√©e + Notebook = üî•]{.smaller} {auto-animate="true" auto-animate-easing="ease-in-out"}

::: r-hstack
::: {data-id="box1" auto-animate-delay="0" style="background: #3fb61840; width: 200px; height: 150px; margin-top: 200px; margin-right: 150px;"}
:::

::: {data-id="box2" auto-animate-delay="0.1" style="background: #f2a42340; width: 200px; height: 150px; margin-top: 200px; margin-left: 150px;"}
:::
:::

::: div1
::: left
[Programmation lettr√©e]{style="color:#3fb61840;"}
:::

::: right
[Notebook]{style="color:#f2a42340;"}
:::
:::

## [Programmation lettr√©e + Notebook = üî•]{.smaller} {auto-animate="true" auto-animate-easing="ease-in-out"}

::: r-hstack
::: {data-id="box1" style="background: #3fb61840; width: 400px; height: 250px; margin-top: 125px; margin-right: -80px;"}
:::

::: {data-id="box2" style="background: #f2a42340;  width: 400px; height: 250px; margin-top: 125px; margin-left: -80px;"}
:::
:::

\

::: {.center2 auto-animate-delay="2"}
[Reproductibilit√© ?]{style="color:#555919;"}
:::

## [PL + NB + ... ? = reproductibilit√©]{.smaller} {auto-animate="true" auto-animate-easing="ease-in-out"}

::: r-hstack
::: {data-id="box1" auto-animate-delay="0" style="background: #3fb61840; width: 200px; height: 150px; margin-top: 30px; margin-right: 150px;"}
:::

::: {data-id="box2" auto-animate-delay="0.2" style="background: #f2a42340; width: 200px; height: 150px; margin-top: 30px; margin-left: 150px;"}
:::

::: {.absolute data-id="box3" auto-animate-delay="3" style="background: #f2262340; width: 200px; height: 150px; margin-top: 600px; margin-right: 505px;"}
:::

::: {.absolute data-id="box4" auto-animate-delay="7" style="background: #2336f240; width: 200px; height: 150px; margin-top: 600px; margin-left: 505px;"}
:::
:::

::: {.div1 auto-animate-delay="1"}
::: left
[Programmation lettr√©e]{style="color:#3fb61840;"}
:::

::: right
[Notebook]{style="color:#f2a42340;"}
:::
:::

::: {.left2 auto-animate-delay="4.5"}
[Informations de session<br>et d'environnement]{style="color:#f2262340;"}
:::

::: {.right2 auto-animate-delay="8.5"}
[Archivage & partage</br>Conditions d'utilisation]{style="color:#2336f240;"}
:::

## [PL + NB + ... ? = reproductibilit√©]{.smaller} {auto-animate="true" auto-animate-easing="ease-in-out"}

::: r-hstack
::: {data-id="box1" style="background: #3fb61840; width: 300px; height: 250px; margin-top: 170px; margin-right: -50px;"}
:::

::: {data-id="box2" style="background: #f2a42340;  width: 300px; height: 250px; margin-top: 170px; margin-left: -50px;"}
:::

::: {.absolute data-id="box3" auto-animate-delay="0" style="background: #f2262340;  width: 300px; height: 250px; margin-top: 0px; "}
:::

::: {.absolute data-id="box4" auto-animate-delay="0.1" style="background: #2336f240;  width: 300px; height: 250px; margin-top: 350px; "}
:::

::: {.absolute data-id="box5" auto-animate-delay="2.4" style="background: white;  width: 100px; height: 77px; margin-top:175px;"}
:::
:::

<!-- ##  Optimiser la reproductibilit√© -->

<!-- :::left3 -->

<!-- [[**Documenter**]{.bigter}]{.orange} -->

<!-- [A. Quel **environnement** utilis√© ?]{.moy2} -->

<!-- :::{.nonincremental style="font-size:50%;"} -->

<!-- - Syst√®me exploitation ? -->

<!-- - Version de Quarto ? -->

<!-- - Version de R ? -->

<!-- - Version de ojs ? -->

<!-- - Version de Rstudio ? -->

<!-- - Versions des packages utilis√©s ? -->

<!-- - ... -->

<!-- ::: -->

<!-- [B. **Documentation suppl√©mentaire**]{.moy2} -->

<!-- [C. **_Image_ docker de l'environnement**]{.moy2} -->

<!-- ::: -->

<!-- :::right3 -->

<!-- [[**Archiver**]{.bigter}]{.orange} -->

<!-- [A. **Mise en ligne du notebook**]{.moy2} -->

<!-- [B. **Partage du code source**]{.moy2} -->

<!-- [C. **Partage de documentation**]{.moy2} -->

<!-- [D. **Utilisation de licences (code et document)**]{.moy2} -->

<!-- :::{.fragment} -->

<!-- ![](img/git.png){width="30%"} -->

<!-- ![](img/gitlab.png){width="20%"} -->

<!-- ![](img/github_blanc.png){width="30%"} -->

<!-- ::: -->

<!-- ::: -->

## [Quel outil pour l'archivage/partage ?]{.smaller}

\

[[‚Üí **GitLab** ou **GitHub** (**Git**)]{.txt1}]{.orange}

::: div3
[[**Git**](https://git-scm.com/) **est un syst√®me de gestion de version** distribu√© pour :]{.txt2}

::: {.nonincremental style="margin-top:0px;font-size:72%;line-height:0.9em"}
-   tracker les changements dans les fichiers texte
-   g√©rer l'historique du code source
-   partager le code dans des d√©pots distants
:::
:::

::: div3
[[**GitLab**](https://about.gitlab.com/) **et [GitHub](https://github.com/) sont des services web d'h√©bergement et de gestion de version** (issue tracker, collaboration, h√©bergement web, CI/CD), qui reposent sur le logiciel de version [**Git**](https://git-scm.com/)]{.txt2}
:::

## [Notebook + GitLab (ou GitHub)]{.smaller}

::: {.nonincremental style="font-size:80%;margin-top:40px;"}
-   Les sources des **notebooks sont de simples fichiers texte**

::: {.nonincremental style="font-size:80%;margin-top:-20px;"}
‚û°Ô∏è Suivi des modifications (*commit*, branches, etc.)¬†\
‚û°Ô∏è [**Archivage et partage** (d√©p√¥t public ou priv√©)]{.orange}
:::

\

-   GitLab et GitHub permettent de [**compiler un notebook**]{.orange}

::: {.nonincremental style="font-size:80%;margin-top:-20px;"}
‚û°Ô∏è *Continuous Integration*
:::

\

-   Ils permettent de [**d√©ployer un notebook compil√© en HTML**]{.orange} [**sur le web**]{.orange}

::: {.nonincremental style="font-size:80%;margin-top:-20px;"}
‚û°Ô∏è *Continuous Deployment*
:::
:::

# Exemple

## [Ceci est un notebook !]{.smaller}

[Un peu de code :]{.txt3}

```{r, echo=TRUE, eval=TRUE, warning=FALSE, message=FALSE}

# Chargement des librairies
library(sf)
library(leaflet)

# Cr√©ation d'une point (localisation de l'amphi Turing - Universit√© de Paris)
ptsfg <- st_point(c(2.3807381923614552, 48.827114532567876))

# On pr√©cise le syst√®me g√©ographique de r√©f√©rence utilis√© (WGS84)
ptsfc <- st_sfc(ptsfg, crs = (4326))

# Cr√©ation d'un tableau contenant deux attributs
ptdf <- data.frame(id= 1, text = "Semaine Data-SHS 2022 ‚ù§Ô∏è")

# Construction d'un objet g√©ographique (point + attributs)
Here <- st_sf(ptdf,geometry = ptsfc)

# Cartographie interactive (Leaflet] - affichage d'un marker (point cr√©√©)
mamap <- leaflet(Here, width = 950, height = 550) %>%
            addTiles() %>%
            addMarkers(data = Here, popup = Here$text)
```

## [Ceci est un notebook !]{.smaller}

[Affichage du r√©sultat :]{.txt3}

```{r, echo=FALSE}

mamap

```

## [Ceci est un notebook !]{.smaller}

\

[**Document libre** :]{.txt1}

[Code source (GitHub) : <https://github.com/HuguesPecout/DataSHS_2022>]{.txt2}\
[Slides en ligne via Github : <https://huguespecout.github.io/DataSHS_2022/>]{.txt2}

\

[**Conditions d'utilisation** :]{.txt1}

[Code source : Licence [MIT]()]{.txt2}\
[Diaporama : [CC BY-SA 3.0](https://creativecommons.org/licenses/by-sa/3.0/fr/)]{.txt2}


## [Info session]{.smaller}


<br>

```{r, echo=FALSE, eval=TRUE}

sessionInfo()

```

## [Exemple divers]{.smaller}

::: left
\

[Communication]{.bigquat}

::: {.nonincremental style="font-size:110%;"}
-   [Data - SHS]()
-   [Pr√©sentation de R]()
-   [Introduction √† R]()
:::

¬†

[Site web statique]{.bigquat}

::: {.nonincremental style="font-size:110%;"}
-   [Rzine.fr]()
-   [Groupe ElementR]()
-   [Ecole d'√©t√© CIST]()
:::
:::

::: right
\

[Livre - manuel]{.bigquat}

::: {.nonincremental style="font-size:110%;"}
-   [Cartographie avec R]()
-   [G√©omatique avec R]()
:::

\

\

[Collection fiche Rzine]{.bigquat}

::: {.nonincremental style="font-size:110%;"}
-   [Analyse mutliscalaire]()
-   [Cartographie en 2.5D]()
-   [Analyse des corr√©lations]()
:::
:::



## 

\

\

:::center2

[**Merci de votre attention**]{.bigquat}

:::

\

\

:::center2

[[hugues.pecout\@cnrs.fr](mailto:hugues.pecout@cnrs.fr)]{.txt2}

[<img src="img/twitter.png" width="40" style="margin-top:15px;margin-bottom:-10px;margin-right:10px;"/>](https://gitlab.huma-num.fr/rzine/site)[@rzine_shs]{.txt2}

:::
